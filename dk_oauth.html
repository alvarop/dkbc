<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>DKBC OAuth Callback</title>

  <meta name="theme-color" content="#fafafa">
  <script type="text/javascript">
  /**
   * Get the URL parameters
   * source: https://css-tricks.com/snippets/javascript/get-url-variables/
   * @param  {String} url The URL
   * @return {Object}     The URL parameters
   */
  var getParams = function (url) {
    var params = {};
    var parser = document.createElement('a');
    parser.href = url;
    var query = parser.search.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
      var pair = vars[i].split('=');
      params[pair[0]] = decodeURIComponent(pair[1]);
    }
    return params;
  };

  var save_client_id = function() {
    localStorage.client_id = document.getElementById("client_id").value;
  }

  document.addEventListener('DOMContentLoaded', function () {
      params = getParams(window.location.href);
      if(params["error"]) {
        document.getElementById("message").innerHTML = "Error: " + params["error"];
      } else if(params["code"]) {
        document.getElementById("message").innerHTML = "Code is: " + params["code"];
      }

      if(localStorage.client_id != null) {
        document.getElementById("client_id").value = localStorage.client_id;
      }

    });
  </script>
</head>

<body>
  <p>DKBC OAuth Callback</p>
  <h2 id="message">Something went wrong...</h2>
</body>

</html>
